%%%%%%%%%%%%
%%% COMPILING CHAPTERS ONLY
%%% thesis_master.lyx has its own preamble in document
%%%%%%%%%%%%

% include the comments when we output. This is so we get the bibliography when previewing this chapter on its own
\usepackage{comment}
\includecomment{comment}

% stop LaTeX from putting hyphens everywhere (but allow a few)
\hyphenpenalty=5000

%Attempt to avoid nasty widows and orphans
\clubpenalty=9999
\widowpenalty=9999

% Make figure captions look nice. Small, sans-serif, bold Fig X.X bit
\usepackage[margin=10pt,font={footnotesize,sf},labelfont=bf,labelsep=endash]{caption}

% Make chapter headings use a sans-serif font
\usepackage[{sf,bf}]{titlesec}

% Make tables use a small sans-serif font
%\usepackage{floatrow}
%\floatsetup[table]{font={small,sf}}
\makeatletter
\renewenvironment{table}%
  {\renewcommand{\familydefault}{\sfdefault}\selectfont
  \@float{table}}
  {\end@float}
\makeatother

% centre tables and figures on the page
\let\originaltabular\tabular
\let\endoriginaltabular\endtabular
\renewenvironment{tabular}[1]{%
  \begingroup%
  \centering%
  \originaltabular{#1}}%
  {\endoriginaltabular\endgroup}

\let\originaltable\table
\let\endoriginaltable\endtable
\renewenvironment{table}[1][ht]{%
  \originaltable[#1]
  \centering}%
  {\endoriginaltable}

\let\originalfigure\figure
\let\endoriginalfigure\endfigure
\renewenvironment{figure}[1][ht]{%
  \originalfigure[#1]
  \centering}%
  {\endoriginalfigure}

% package that allows \resizebox to squeeze tables
\usepackage{graphicx}

% format the natbib citations to be separated with semi-colons etc
\bibpunct[; ]{(}{)}{;}{a}{,}{;}

% make the bibliography have single line spacing
\usepackage{setspace}
\let\oldbibliography\bibliography
\renewcommand{\bibliography}[1]{\setstretch{1}\oldbibliography{#1}}

% code highlighting
\usepackage{listings}
\usepackage{color}
\lstset{ %
language=C++,                % choose the language of the code
basicstyle={\scriptsize,\ttfamily},       % the size of the fonts that are used for the code
numbers=left,                   % where to put the line-numbers
numberstyle=\tiny,      % the size of the fonts that are used for the line-numbers
stepnumber=1,                   % the step between two line-numbers. If it is 1 each line will be numbered
numbersep=5pt,                  % how far the line-numbers are from the code
showspaces=false,               % show spaces adding particular underscores
showstringspaces=false,         % underline spaces within strings
showtabs=false,                 % show tabs within strings adding particular underscores
tabsize=2,          % sets default tabsize to 2 spaces
captionpos=b,           % sets the caption-position to bottom
breaklines=true,        % sets automatic line breaking
breakatwhitespace=false,    % sets if automatic breaks should only happen at whitespace
}
